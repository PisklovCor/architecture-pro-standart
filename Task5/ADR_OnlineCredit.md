### **Название задачи:** Онлайн заявка на кредит с предодобренными предложениями
### **Автор:** Архитектор банка "Стандарт"
### **Дата:** 01.09.2025

### **Функциональные требования**

Опишите здесь верхнеуровневые Use Cases. Их нужно оформить в виде таблицы с пошаговым описанием:

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
|UC1|Существующий клиент банка|Просмотр предодобренных кредитных предложений|1. Клиент авторизуется в интернет-банке<br/>2. Переходит в раздел "Кредиты"<br/>3. Система показывает персональные предодобренные предложения<br/>4. Клиент изучает условия: сумма, ставка, срок<br/>5. Система отображает предварительный график платежей|
|UC2|Существующий клиент банка|Подача заявки на предодобренный кредит|1. Клиент выбирает предодобренное предложение<br/>2. Указывает желаемую сумму в пределах лимита<br/>3. Выбирает срок кредитования<br/>4. Подтверждает заявку СМС-кодом<br/>5. Система отправляет заявку в кредитный конвейер<br/>6. Клиент получает номер заявки и сроки рассмотрения|
|UC3|Новый клиент сайта|Подача заявки на кредит с сайта|1. Клиент открывает сайт банка<br/>2. Выбирает продукт "Кредит"<br/>3. Заполняет анкету: ФИО, паспорт, телефон, доходы<br/>4. Система запрашивает кредитную историю в БКИ<br/>5. Выполняется предварительный скоринг<br/>6. Клиент получает предварительное решение с условиями|
|UC4|Система кредитного скоринга|Оценка кредитоспособности клиента|1. Получает данные клиента из заявки<br/>2. Запрашивает кредитную историю в БКИ<br/>3. Анализирует данные через ML-модель<br/>4. Рассчитывает скоринговый балл<br/>5. Определяет максимальную сумму и ставку<br/>6. Возвращает решение в кредитный конвейер|
|UC5|Кредитный конвейер|Обработка кредитной заявки|1. Получает заявку из интернет-банка или сайта<br/>2. Валидирует данные клиента<br/>3. Запускает процесс скоринга<br/>4. Получает результат оценки кредитоспособности<br/>5. Принимает решение об одобрении/отклонении<br/>6. Обновляет статус заявки в АБС|
|UC6|Сотрудник кредитного отдела|Ручное рассмотрение сложных заявок|1. Получает уведомление о заявке в кредитном конвейере<br/>2. Анализирует данные клиента и скоринг<br/>3. При необходимости запрашивает дополнительные документы<br/>4. Принимает окончательное решение<br/>5. Обновляет статус заявки с комментариями<br/>6. Система уведомляет клиента о решении|
|UC7|Клиент|Получение уведомлений о статусе заявки|1. Система отправляет СМС при изменении статуса<br/>2. Клиент получает уведомление о решении<br/>3. При одобрении - информация о сумме и ставке<br/>4. Для новых клиентов - приглашение в отделение<br/>5. При отклонении - краткая причина отказа|
|UC8|Система предодобрения|Генерация персональных предложений|1. Система ежедневно анализирует клиентскую базу<br/>2. Для каждого клиента рассчитывает скоринг<br/>3. Определяет персональные условия кредитования<br/>4. Создает предодобренные предложения<br/>5. Публикует их в интернет-банке для клиентов|

### **Нефункциональные требования**

Опишите здесь нефункциональные требования и архитектурно значимые требования.

|**№**|**Требование**|
| :-: | :- |
|NFR1|**Производительность**: Время ответа системы скоринга не более 5 секунд, расчет предодобренных предложений не более 30 секунд на клиента|
|NFR2|**Масштабируемость**: Система должна обрабатывать до 1000 заявок в день с возможностью увеличения в 5 раз|
|NFR3|**Надежность**: Доступность кредитного конвейера 99,5%, с автоматическим восстановлением при сбоях|
|NFR4|**Безопасность**: Шифрование всех данных при передаче, логирование обращений к БКИ, контроль доступа к персональным данным|
|NFR5|**Интеграция**: Совместимость с существующими системами (Camunda, АБС, БКИ) через API|
|NFR6|**Быстрота решений**: Автоматическое принятие решений по предодобренным заявкам в течение 1 часа|
|NFR7|**Аудит**: Полное логирование всех этапов процесса для соответствия требованиям ЦБ РФ|
|NFR8|**Персонализация**: Индивидуальные условия для VIP-клиентов и различных сегментов|
|NFR9|**Регулятивные требования**: Соответствие требованиям 115-ФЗ по идентификации клиентов|
|NFR10|**Восстановление данных**: Возможность повторного запроса в БКИ при сбоях, backup кредитных решений|

### **Решение**

#### Концептуальная архитектура онлайн кредитования

**Принципы архитектурных решений:**

1. **Использование существующей кредитной инфраструктуры** - максимальное использование кредитного конвейера и системы скоринга
2. **Персонализация предложений** - предварительный расчет кредитных условий для существующих клиентов
3. **Быстрые решения** - автоматизация принятия решений для простых случаев
4. **Безопасная интеграция с БКИ** - контролируемые запросы к внешним источникам данных

#### Основные компоненты решения:

**1. Сервис предодобренных предложений** (новый микросервис)
- Технологии: Python, PostgreSQL (совместимость со скорингом)
- Функции: ежедневный расчет персональных кредитных предложений
- Интеграция с системой скоринга для оценки существующих клиентов

**2. Веб-портал кредитных заявок** (новый микросервис)
- Технологии: ASP.NET Core, MS SQL
- Функции: прием заявок с сайта и интернет-банка, отображение предложений
- Интеграция с интернет-банком через REST API

**3. Адаптер для БКИ** (новый микросервис)
- Технологии: Java Spring Boot (совместимость с конвейером)
- Функции: безопасное взаимодействие с Бюро кредитных историй
- Контроль лимитов запросов и кэширование ответов

**4. Расширение кредитного конвейера**
- Добавление новых обработчиков в Camunda для онлайн заявок
- Автоматические решения для предодобренных заявок
- Интеграция с веб-порталом через Kafka

**5. Улучшение системы скоринга**
- Добавление API для массового расчета предложений
- Оптимизация ML-модели для быстрых решений
- Интеграция с адаптером БКИ

#### Архитектурная схема:

```
Клиенты → [Сайт / Интернет-банк] → Веб-портал кредитных заявок
                                         ↓ (Kafka)
Предодобренные предложения ← Система скоринга ← Кредитный конвейер
         ↓                        ↑                     ↓
   Интернет-банк              Адаптер БКИ              АБС
                                   ↓
                           Бюро кредитных историй
```

#### Диаграммы архитектуры:
- `context_diagram_credit.puml` - диаграмма контекста C4 кредитной системы
- `container_diagram_credit.puml` - диаграмма контейнеров C4 с детализацией компонентов

#### Обоснование технологических решений:

**Python для предодобрения** - совместимость с существующей системой скоринга, эффективность ML-вычислений

**Java для БКИ-адаптера** - совместимость с кредитным конвейером на Camunda, надежность интеграций

**Camunda** - использование существующей BPM-платформы для управления процессами

**Kafka** - асинхронная интеграция для надежной передачи заявок между компонентами

**API-first подход** - обеспечение интеграции между микросервисами и существующими системами

### **Альтернативы**

#### Альтернатива 1: Полная автоматизация без предодобрения
**Описание:** Все заявки обрабатываются в реальном времени через систему скоринга
**Преимущества:** Простота архитектуры, мгновенные решения
**Недостатки:** Высокая нагрузка на БКИ, отсутствие персонализированных предложений

#### Альтернатива 2: Интеграция с внешней скоринговой платформой
**Описание:** Использование облачного решения для кредитного скоринга
**Преимущества:** Готовые ML-модели, масштабируемость
**Недостатки:** Зависимость от внешнего провайдера, сложности с регулятивными требованиями

#### Альтернатива 3: Минимальная доработка существующих систем
**Описание:** Добавление веб-формы с направлением заявок в существующий процесс
**Преимущества:** Минимальные изменения, быстрая реализация
**Недостатки:** Медленные решения, отсутствие автоматизации, плохой UX

#### Альтернатива 4: Создание единой кредитной платформы
**Описание:** Объединение всех кредитных процессов в одну новую систему
**Преимущества:** Современная архитектура, полная интеграция
**Недостатки:** Высокие риски, длительная разработка, потеря существующих инвестиций

### **Недостатки, ограничения, риски**

#### Недостатки выбранного решения:
1. **Сложность интеграции** - необходимость координации работы нескольких систем
2. **Дублирование данных** - хранение предодобренных предложений отдельно от основных систем
3. **Зависимость от внешних API** - критическая зависимость от доступности БКИ

#### Ограничения:
1. **Регулятивные требования** - новые клиенты обязаны проходить личную идентификацию
2. **Лимиты БКИ** - ограничения на количество запросов кредитных историй
3. **Производительность ML** - ограничения скорости обработки сложных скоринговых моделей
4. **Существующие системы** - необходимость совместимости с Camunda и текущим стеком

#### Риски:
1. **Интеграционные риски** - сбои в одном компоненте могут нарушить весь процесс
2. **Операционные риски** - некорректные кредитные решения при сбоях скоринга
3. **Безопасность данных** - риски утечки при передаче персональных данных между системами
4. **Производительность БКИ** - влияние недоступности внешнего API на работу системы
5. **Регулятивные изменения** - изменения требований ЦБ могут потребовать переработки логики
6. **Качество ML-модели** - риск неточных кредитных решений при недостатке данных для обучения
7. **Масштабирование** - необходимость увеличения мощностей при росте количества заявок
