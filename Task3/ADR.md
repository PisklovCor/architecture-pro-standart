### <a name="_b7urdng99y53"></a>**Название задачи:** MVP открытия депозитов онлайн
### <a name="_hjk0fkfyohdk"></a>**Автор:** Архитектор банка "Стандарт"
### <a name="_uanumrh8zrui"></a>**Дата:** 01.09.2025
### <a name="_3bfxc9a45514"></a>**Функциональные требования**
Опишите здесь верхнеуровневые Use Cases. Их нужно оформить в виде таблицы с пошаговым описанием:

|**№**|**Действующие лица или системы**|**Use Case**|**Описание**|
| :-: | :- | :- | :- |
|UC1|Клиент сайта|Подача заявки на депозит с сайта|1. Клиент открывает сайт банка<br/>2. Выбирает продукт "Депозит"<br/>3. Заполняет форму: ФИО, телефон, email, сумма депозита<br/>4. Отправляет заявку<br/>5. Получает подтверждение с номером заявки|
|UC2|Клиент интернет-банка|Подача заявки на депозит из интернет-банка|1. Клиент авторизуется в интернет-банке<br/>2. Переходит в раздел "Депозиты"<br/>3. Выбирает тип депозита и срок<br/>4. Указывает счет списания и сумму<br/>5. Подтверждает заявку СМС-кодом<br/>6. Получает уведомление о создании заявки|
|UC3|Система ставок|Отображение актуальных ставок|1. Система ежедневно получает ставки рефинансирования ЦБ<br/>2. Рассчитывает актуальные ставки по депозитам<br/>3. Обновляет ставки на сайте и в интернет-банке<br/>4. Отображает персонализированные ставки для VIP-клиентов|
|UC4|Сотрудник бэк-офиса|Обработка заявки на депозит|1. Получает уведомление о новой заявке в АБС<br/>2. Проверяет данные клиента и заявки<br/>3. Рассчитывает индивидуальную ставку (при необходимости)<br/>4. Принимает решение об одобрении/отклонении<br/>5. Обновляет статус заявки в АБС<br/>6. Система отправляет СМС клиенту|
|UC5|Клиент|Получение уведомлений о статусе|1. Система отправляет СМС при изменении статуса заявки<br/>2. Клиент получает уведомление об одобрении/отклонении<br/>3. При одобрении клиент получает инструкции для оформления<br/>4. Для новых клиентов - приглашение в отделение для идентификации|
### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**
Опишите здесь нефункциональные требования и архитектурно значимые требования.

|**№**|**Требование**|
| :-: | :- |
|NFR1|**Производительность**: Время отклика интерфейса не более 100 мс, время загрузки справочных данных не более 500 мс|
|NFR2|**Надежность**: Доступность системы 99,9% (24/7) с автоматическим переключением на резервный ЦОД|
|NFR3|**Безопасность**: Шифрование всех данных при передаче (HTTPS/TLS), подтверждение операций через СМС-код|
|NFR4|**Масштабируемость**: Горизонтальное масштабирование веб-слоя для обработки растущей нагрузки|
|NFR5|**Совместимость**: Использование знакомых технологий (.NET, Oracle, MS SQL) для минимизации рисков|
|NFR6|**Интеграция**: Ограниченная интеграция с ядром интернет-банка, избежание прямого API к АБС|
|NFR7|**Регулятивные требования**: Личная идентификация новых клиентов в отделении по требованиям ЦБ РФ|
|NFR8|**Аудит**: Логирование всех операций для отслеживания и соответствия требованиям безопасности|
### <a name="_qmphm5d6rvi3"></a>**Решение**

#### Концептуальная архитектура MVP

**Принципы архитектурных решений:**

1. **Минимальная доработка существующих систем** - используем текущий стек технологий (.NET, Oracle) для снижения рисков внедрения
2. **Поэтапная интеграция** - MVP предполагает ручную обработку заявок в АБС, полная автоматизация - в следующих итерациях  
3. **Безопасность данных** - избегаем прямого API к АБС, используем асинхронную интеграцию через Kafka
4. **Масштабируемость** - новые компоненты проектируем как микросервисы для горизонтального масштабирования

#### Основные компоненты решения:

**1. Веб-портал депозитов** (новый микросервис)
- Технологии: ASP.NET Core, MS SQL
- Функции: прием заявок с сайта и интернет-банка, отображение актуальных ставок
- Интеграция с интернет-банком через REST API (ограниченная)

**2. Сервис управления ставками** (новый микросервис)  
- Технологии: ASP.NET Core, MS SQL
- Функции: расчет актуальных ставок, персонализация для VIP-клиентов
- Ежедневная синхронизация ставок с внешними источниками

**3. Интеграционная шина** (расширение Kafka)
- Асинхронная передача заявок в АБС
- Уведомления об изменении статусов заявок
- Логирование всех операций для аудита

**4. СМС-сервис** (использование существующего)
- Подтверждение операций в интернет-банке
- Уведомления о статусе заявок

#### Диаграммы архитектуры:
- `context_diagram.puml` - диаграмма контекста C4 (PlantUML)
- `container_diagram.puml` - диаграмма контейнеров C4 с детализацией интернет-банка и АБС (PlantUML)
- `context_diagram.drawio` - диаграмма контекста C4 (Mermaid/Draw.io)
- `container_diagram.drawio` - диаграмма контейнеров C4 (Mermaid/Draw.io)

#### Обоснование технологических решений:

**ASP.NET Core** - соответствует текущему стеку команды, обеспечивает производительность и масштабируемость

**MS SQL** - знакомая СУБД, простая интеграция с существующими системами  

**Kafka** - стратегическое решение банка для очередей сообщений, обеспечивает надежность доставки

**Микросервисная архитектура** - позволяет независимо развивать и масштабировать компоненты
### <a name="_bjrr7veeh80c"></a>**Альтернативы**

#### Альтернатива 1: Прямая интеграция с АБС
**Описание:** Добавление API в АБС для прямого приема заявок от интернет-банка и сайта
**Преимущества:** Простота архитектуры, минимум компонентов  
**Недостатки:** Риск перегрузки критической системы АБС, нарушение принципа изоляции систем

#### Альтернатива 2: Доработка существующего интернет-банка
**Описание:** Расширение монолитного интернет-банка функционалом депозитов
**Преимущества:** Использование существующей инфраструктуры и команды  
**Недостатки:** Зависимость от подрядчика для обновления ядра, ограничения масштабируемости монолита

#### Альтернатива 3: Внешняя платформа (BaaS)
**Описание:** Использование внешней Banking-as-a-Service платформы для обработки заявок
**Преимущества:** Быстрая реализация, готовый функционал  
**Недостатки:** Зависимость от внешнего провайдера, сложности интеграции с АБС, регулятивные ограничения

### **Недостатки, ограничения, риски**

#### Недостатки выбранного решения:
1. **Сложность архитектуры** - добавление новых микросервисов увеличивает общую сложность системы
2. **Временные затраты** - разработка новых компонентов требует больше времени по сравнению с доработкой существующих
3. **Ручная обработка** - в MVP сохраняется участие сотрудников бэк-офиса, что не устраняет операционные издержки

#### Ограничения:
1. **Регулятивные требования** - новые клиенты обязаны проходить личную идентификацию в отделении
2. **Интеграционные ограничения** - избегание прямого API к АБС ограничивает возможности real-time интеграции  
3. **Технологический стек** - привязка к существующим технологиям (.NET, Oracle) может ограничить выбор решений

#### Риски:
1. **Риск интеграции** - сложности при подключении новых сервисов к существующим системам через Kafka
2. **Операционный риск** - временное увеличение нагрузки на сотрудников бэк-офиса при запуске MVP
3. **Производительность** - необходимость обеспечения SLA по времени отклика при росте нагрузки
4. **Безопасность** - новые точки интеграции создают дополнительные векторы атак
5. **Изменение требований** - регулятивные изменения могут потребовать существенной переработки решения

